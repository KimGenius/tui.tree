<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <link type="text/css" rel="stylesheet" href="../styles/prettify-jsdoc.css" />
    <link type="text/css" rel="stylesheet" href="../styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="../styles/tui.css">

    <title>트리컴포넌트</title>
    <link rel="stylesheet" href="css/tree.css" />
    <link rel="stylesheet" href="css/contextmenu.css" />
</head>
<body>
    <div class="wrap" style="height:500px;">
        <div class="treeWrap" style="position:relative;border:1px solid #eaeaea;">
            <ul id="treeRoot1" class="tree"></ul>
        </div>
        <div style="position:absolute;top:10px;left:305px;text-align:center;">
            <p><b>This sample page is not working below IE7!</b></p>
            <div style="border:3px solid #eee;margin:5px;padding:0 10px 10px 10px;text-align:left;">
                <p style="margin:10px">feature test 1 : default, selectable, draggable (support IE7+)</p>
                <div>
                    <button id="addChildBtn">addChild</button>
                    <button id="removeChildBtn">removeChild</button>
                    <button id="sortBtn">sortBtn</button>
                </div>
                <div>
                    <button id="enableSelectionBtn">enableSelection</button>
                    <button id="disableSelectionBtn">disableSelection</button>
                </div>
                <div>
                    <button id="enableDNDBtn">enableDragAndDrop</button>
                    <button id="disableDNDBtn">disableDragAndDrop</button>
                </div>
            </div>
            <div style="border:3px solid #eee;margin:5px;padding:0 10px 10px 10px;text-align:left;">
                <p style="margin:10px;">feature test 2 : context-menu (support IE8+)</p>
                <div>
                    <button id="enableContextMenuBtn">enableContextMenu</button>
                    <button id="disableContextMenuBtn">disableContextMenu</button>
                </div>
            </div>
        </div>
    </div>

    <div class="codeArea"></div>

    <script type="text/javascript" src="js/code-snippet.js"></script>
    <!-- library files for context-menu feature -->
    <script type="text/javascript" src="js/domutil.js"></script>
    <script type="text/javascript" src="js/floatinglayer.js"></script>
    <script type="text/javascript" src="js/contextmenu.js"></script>
    <!-- // library files for context-menu feature -->
    <script type="text/javascript" src="js/tree.js"></script>

    <script src="../scripts/prettify/prettify.js"></script>
    <script src="../scripts/prettify/lang-css.js"></script>
    <script src="../scripts/jquery.js"></script>
    <script src="../scripts/samplecode.js"></script>
    <script class="serviceCode">
        var util = {
            addEventListener: function(element, eventName, handler) {
                if (element.addEventListener) {
                    element.addEventListener(eventName, handler, false);
                } else {
                    element.attachEvent('on' + eventName, handler);
                }
            }
        };

        var data = [
            {text: 'rootA', children: [
                {text: 'sub-A1'},
                {text: 'sub-A2'},
                {text: 'sub-A3'},
                {text: 'sub-A4'},
                {text: 'sub-A5', state: 'closed', children: [
                    {text:'sub-A5A', children:[
                        {text:'sub-A5A1'}
                    ]},
                    {text:'sub_A5B'}
                ]},
                {text: 'sub-A6'},
                {text: 'sub-A7'},
                {text: 'sub-A8'},
                {text: 'sub-A9', state: 'closed', children: [
                    {text:'sub-A9A'},
                    {text:'sub-A9B'}
                ]},
                {text: 'sub-A10'},
                {text: 'sub-A11'},
                {text: 'sub-A12'}
            ]},
            {text: 'rootB', state:'closed', children: [
                {text:'sub-B1'},
                {text:'sub-B2'},
                {text:'sub-B3'}
            ]}
        ];

        var tree = new tui.component.Tree(data, {
            nodeDefaultState: 'opened',
            rootElement: document.getElementById('treeRoot1')
        });

        var addChildBtn = document.getElementById('addChildBtn'),
            removeChildBtn = document.getElementById('removeChildBtn'),
            sortBtn = document.getElementById('sortBtn'),
            enableSelectionBtn = document.getElementById('enableSelectionBtn'),
            disableSelectionBtn = document.getElementById('disableSelectionBtn'),
            enableDNDBtn = document.getElementById('enableDNDBtn'),
            disableDNDBtn = document.getElementById('disableDNDBtn'),
            enableContextMenuBtn = document.getElementById('enableContextMenuBtn'),
            disableContextMenuBtn = document.getElementById('disableContextMenuBtn'),
            rootNodeId = tree.getRootNodeId(),
            firstChildId = tree.getChildIds(rootNodeId)[0];

        util.addEventListener(addChildBtn, 'click', function() {
            tree.add({text:'hello world'}, firstChildId);
        });

        util.addEventListener(removeChildBtn, 'click', function() {
            var lastGrandChildId = tree.getChildIds(firstChildId).slice(-1)[0];
            tree.remove(lastGrandChildId);
        });

        util.addEventListener(sortBtn, 'click', function() {
            tree.sort(function(nodeA, nodeB) {
                var aValue = nodeA.getData('text'),
                    bValue = nodeB.getData('text');

                if (!aValue.localeCompare) {
                    return 0;
                }
                return aValue.localeCompare(bValue);
            });
        });

        util.addEventListener(enableSelectionBtn, 'click', function() {
            tree.enableFeature('Selectable');
        });

        util.addEventListener(disableSelectionBtn, 'click', function() {
            tree.disableFeature('Selectable');
        });

        util.addEventListener(enableDNDBtn, 'click', function() {
            tree.enableFeature('Draggable', {
                isSortable: true,
                lineClassName: 'tui-tree-marker',
                lineBoundary: {
                    top: 10,
                    bottom: 10
                }
            });
        });

        util.addEventListener(disableDNDBtn, 'click', function() {
            tree.disableFeature('Draggable');
        });

        util.addEventListener(enableContextMenuBtn, 'click', function() {
            tree.enableFeature('ContextMenu');
        });

        util.addEventListener(disableContextMenuBtn, 'click', function() {
            tree.disableFeature('ContextMenu');
        });

        tree.on('select', function(nodeId) {
            if (window.console) {
                console.log('select! - ' + nodeId);
            } else {
                alert('select! - ' + nodeId);
            }
        });

        tree.on('beforeMove', function(nodeId, parentId) {
            if (nodeId !== 'tui-tree-node-2') { // sub-A1 node
                return true;
            }

            return false;
        });

        tree.on('beforeOpenContextMenu', function(nodeId) {
            var menuData = [];

            if (nodeId === 'tui-tree-node-2') { // sub-A1 node
                menuData = [
                    {title: 'menu'}
                ];
            } else {
                menuData = [
                    {title: 'menu1'},
                    {title: 'menu2', disable: true},
                    {title: 'menu3', menu: [
                        {title: 'submenu1', disable: true},
                        {title: 'submenu2'}
                    ]}
                ];
            }

            tree.changeContextMenu(menuData); // change menu api

            if (tree.enabledFeatures['Selectable']) {
                tree.select(nodeId); // with selectable feature
            }
        });

        tree.on('selectContextMenu', function(e) {
            var msg = '"' + e.cmd + '" is selected on "' + e.nodeId + '" item.';

            if (window.console) {
                console.log(msg);
            } else {
                alert(msg);
            }
        });
    </script>
</body>
</html>
