!function e(t,i,n){function s(r,a){if(!i[r]){if(!t[r]){var l="function"==typeof require&&require;if(!a&&l)return l(r,!0);if(o)return o(r,!0);var u=new Error("Cannot find module '"+r+"'");throw u.code="MODULE_NOT_FOUND",u}var h=i[r]={exports:{}};t[r][0].call(h.exports,function(e){var i=t[r][1][e];return s(i?i:e)},h,h.exports,e,t,i,n)}return i[r].exports}for(var o="function"==typeof require&&require,r=0;r<n.length;r++)s(n[r]);return s}({1:[function(e,t,i){"use strict";var n=e("./src/js/tree"),s=tui.util.defineNamespace("tui.component");s.Tree=n},{"./src/js/tree":13}],2:[function(e,t,i){"use strict";t.exports={READ:"read",CREATE:"create",UPDATE:"update",DELETE:"remove",DELETE_ALL_CHILDREN:"removeAllChildren",MOVE:"move"}},{}],3:[function(e,t,i){"use strict";function n(e,t){var i={};return tui.util.forEach(t,function(t){i[t+"Class"]=e+t}),i}t.exports={nodeDefaultState:"closed",stateLabels:{opened:"-",closed:"+"},nodeIdPrefix:"tui-tree-node-",classNames:n("tui-tree-",["node","leaf","opened","closed","subtree","toggleBtn","text"]),template:{internalNode:'<button type="button" class="{{toggleBtnClass}}">{{stateLabel}}</button><span class="{{textClass}}">{{text}}</span><ul class="{{subtreeClass}}">{{children}}</ul>',leafNode:'<span class="{{textClass}}">{{text}}</span>'}}},{}],4:[function(e,t,i){"use strict";t.exports={INVALID_ROOT_ELEMENT:'"tui-component-tree": Root element is invalid.',INVALID_API:'"tui-component-tree": INVALID_API',INVALID_API_SELECTABLE:'"tui-component-tree": The feature-"Selectable" is not enabled.',INVALID_API_EDITABLE:'"tui-component-tree": The feature-"Editable" is not enabled.',INVALID_API_DRAGGABLE:'"tui-component-tree": The feature-"Draggable" is not enabled.',INVALID_API_CHECKBOX:'"tui-component-tree": The feature-"Checkbox" is not enabled.',INVALID_AJAX_OPTIONS:'"tui-component-tree": The feature-"Ajax" option is not valid.'}},{}],5:[function(e,t,i){"use strict";t.exports={INTERNAL_NODE:'<li id="{{id}}" class="{{nodeClass}} {{stateClass}}">{{innerTemplate}}</li>',LEAF_NODE:'<li id="{{id}}" class="{{nodeClass}} {{leafClass}}">{{innerTemplate}}</li>'}},{}],6:[function(e,t,i){"use strict";t.exports={node:{OPENED:"opened",CLOSED:"closed"}}},{}],7:[function(e,t,i){"use strict";var n=tui.util,s=[],o="tui-tree-loader",r=tui.util.defineClass({"static":{getAPIList:function(){return s.slice()}},init:function(e,t){t=tui.util.extend({},t),this.tree=e,this.command=t.command,this.parseData=t.parseData||null,this.loaderClassName=t.loaderClassName||o,this.isLoadRoot=!!n.isUndefined(t.isLoadRoot)||t.isLoadRoot,this.loader=null,this._createLoader(),e.on("initFeature",n.bind(this._onInitFeature,this))},_onInitFeature:function(){this.isLoadRoot&&this.tree.resetAllData()},destroy:function(){var e=this.tree;this._removeLoader(),e.off(this)},loadData:function(e,t,i){var n,s=this;this.command&&this.command[e]&&this.command[e].url&&(n=this._getDefaultRequestOptions(e,i),this.tree.invoke("beforeAjaxRequest",e,i)&&(this._showLoader(),n.success=function(i){s._responseSuccess(e,t,i)},n.error=function(){s._responseError(e)},$.ajax(n)))},_responseSuccess:function(e,t,i){var n,s=this.tree;this._hideLoader(),this.parseData&&(i=this.parseData(e,i)),i?(n=t(i),s.fire("successAjaxResponse",e,n)):s.fire("failAjaxResponse",e)},_responseError:function(e){this._hideLoader(),this.tree.fire("errorAjaxResponse",e)},_getDefaultRequestOptions:function(e,t){var i=this.command[e];return n.isFunction(i.url)&&(i.url=i.url(t)),n.isFunction(i.data)&&(i.data=i.data(t)),i.type=i.type?i.type.toLowerCase():"get",i.dataType=i.dataType||"json",i},_createLoader:function(){var e=this.tree,t=document.createElement("span");t.className=this.loaderClassName,t.style.display="none",e.rootElement.parentNode.appendChild(t),this.loader=t},_removeLoader:function(){var e=this.tree,t=this.loader;e.rootElement.parentNode.removeChild(t),this.loader=null},_showLoader:function(){this.loader.style.display="block"},_hideLoader:function(){this.loader.style.display="none"}});t.exports=r},{}],8:[function(e,t,i){"use strict";var n=e("../util.js"),s=["check","uncheck","toggleCheck","isChecked","isIndeterminate","isUnchecked","getCheckedList","getTopCheckedList","getBottomCheckedList"],o=1,r=2,a=3,l="__CheckBoxState__",u={},h=tui.util.filter,d=tui.util.forEach,c=tui.util.defineClass({"static":{getAPIList:function(){return s.slice()}},init:function(e,t){t=tui.util.extend({},t),this.tree=e,this.checkboxClassName=t.checkboxClassName,this.checkedList=[],this.rootCheckbox=document.createElement("INPUT"),this.rootCheckbox.type="checkbox",this._setAPIs(),this._attachEvents()},destroy:function(){var e=this.tree;e.off(this),d(s,function(t){delete e[t]})},_setAPIs:function(){var e=this.tree,t=tui.util.bind;d(s,function(i){e[i]=t(this[i],this)},this)},_attachEvents:function(){this.tree.on({singleClick:function(e){var t,i,s=n.getTarget(e);n.hasClass(s,this.checkboxClassName)&&(t=this.tree.getNodeIdFromElement(s),i=this._getStateFromCheckbox(s),this._continuePostprocessing(t,i))},afterDraw:function(e){this.tree.isMovingNode||this._reflectChanges(e)},move:function(e){this._reflectChanges(e.originalParentId),this._reflectChanges(e.newParentId)}},this)},_reflectChanges:function(e){this.tree.each(function(e,t){this._setState(t,this._getState(t),!0)},e,this),this._judgeOwnState(e),this._updateAllAncestorsState(e)},_setCheckboxAttr:function(e,t,i){e.indeterminate=i,e.checked=t},_setState:function(e,t,i){var n=this._getCheckboxElement(e);if(n){switch(t){case o:this._setCheckboxAttr(n,!0,!1);break;case r:this._setCheckboxAttr(n,!1,!1);break;case a:this._setCheckboxAttr(n,!1,!0);break;default:return}this._continuePostprocessing(e,t,i)}},_getState:function(e){var t,i=this.tree,n=i.getNodeData(e)[l];return n||(t=this._getCheckboxElement(e),n=this._getStateFromCheckbox(t)),n},_getStateFromCheckbox:function(e){var t;return e?t=e.checked?o:e.indeterminate?a:r:null},_continuePostprocessing:function(e,t,i){var s,a=this.tree,h=this.checkedList;n.removeItemFromArray(e,h),t===o?(h.push(e),s="check"):t===r&&(s="uncheck"),u[l]=t,a.setNodeData(e,u,{isSilent:!0}),i||(this._propagateState(e,t),a.fire(s,e))},_propagateState:function(e,t){t!==a&&(this._updateAllDescendantsState(e,t),this._updateAllAncestorsState(e))},_updateAllDescendantsState:function(e,t){this.tree.each(function(e,i){this._setState(i,t,!0)},e,this)},_updateAllAncestorsState:function(e){for(var t=this.tree,i=t.getParentId(e);i;)this._judgeOwnState(i),i=t.getParentId(i)},_judgeOwnState:function(e){var t=this.tree,i=t.getChildIds(e),n=!0,s=!0;i.length?d(i,function(e){var t=this._getState(e);return n=n&&t===o,s=s&&t===r,n||s},this):n=this.isChecked(e),n?this._setState(e,o,!0):s?this._setState(e,r,!0):this._setState(e,a,!0)},_getCheckboxElement:function(e){var t,i,s=this.tree;if(e===s.getRootNodeId())t=this.rootCheckbox;else{if(i=document.getElementById(e),!i)return null;t=n.getElementsByClassName(i,this.checkboxClassName)[0]}return t},check:function(e){this.isChecked(e)||this._setState(e,o)},uncheck:function(e){this.isUnchecked(e)||this._setState(e,r)},toggleCheck:function(e){this.isChecked(e)?this.uncheck(e):this.check(e)},isChecked:function(e){return o===this._getState(e)},isIndeterminate:function(e){return a===this._getState(e)},isUnchecked:function(e){return r===this._getState(e)},getCheckedList:function(e){var t=this.tree,i=this.checkedList;return e?h(i,function(i){return t.contains(e,i)}):i.slice()},getTopCheckedList:function(e){var t,i=this.tree,n=[];return e=e||i.getRootNodeId(),t=this._getState(e),t===o?n=i.getChildIds(e):t===a&&(n=this.getCheckedList(e),n=h(n,function(e){return!this.isChecked(i.getParentId(e))},this)),n},getBottomCheckedList:function(e){var t,i=this.tree;return e=e||i.getRootNodeId(),t=this.getCheckedList(e),h(t,function(e){return i.isLeaf(e)})}});tui.util.CustomEvents.mixin(c),t.exports=c},{"../util.js":16}],9:[function(e,t,i){"use strict";var n=e("./../util"),s=["changeContextMenu"],o=tui&&tui.component&&tui.component.ContextMenu,r=["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"],a=n.testProp(r),l=tui.util.bind,u=tui.util.defineClass({"static":{getAPIList:function(){return s.slice()}},init:function(e,t){t=t||{},this.tree=e,this.treeSelector="#"+this.tree.rootElement.id,this.flId=this.tree.rootElement.id+"-fl",this.menu=this._generateContextMenu(),this.flElement=document.getElementById(this.flId),this.selectedNodeId=null,this.menu.register(this.treeSelector,l(this._onSelect,this),t.menuData||{}),this.tree.on("contextmenu",this._onContextMenu,this),this._preventTextSelection(),this._setAPIs()},changeContextMenu:function(e){this.menu.unregister(this.treeSelector),this.menu.register(this.treeSelector,l(this._onSelect,this),e)},destroy:function(){var e=this.tree;this.menu.destroy(),this._restoreTextSelection(),this._removeFloatingLayer(),e.off(this),tui.util.forEach(s,function(t){delete e[t]})},_createFloatingLayer:function(){this.flElement=document.createElement("div"),this.flElement.id=this.flId,document.body.appendChild(this.flElement)},_removeFloatingLayer:function(){document.body.removeChild(this.flElement),this.flElement=null},_generateContextMenu:function(){return this.flElement||this._createFloatingLayer(),new o(this.flElement)},_preventTextSelection:function(){a&&(this.tree.rootElement.style[a]="none")},_restoreTextSelection:function(){a&&(this.tree.rootElement.style[a]="")},_onContextMenu:function(e){var t=n.getTarget(e);this.selectedNodeId=this.tree.getNodeIdFromElement(t),this.tree.fire("beforeOpenContextMenu",this.selectedNodeId)},_onSelect:function(e,t){this.tree.fire("selectContextMenu",{cmd:t,nodeId:this.selectedNodeId})},_setAPIs:function(){var e=this.tree;tui.util.forEach(s,function(t){e[t]=l(this[t],this)},this)}});t.exports=u},{"./../util":16}],10:[function(e,t,i){"use strict";var n=e("./../util"),s={useHelper:!0,helperPos:{y:2,x:5},autoOpenDelay:1500,isSortable:!1,hoverClassName:"tui-tree-hover",lineClassName:"tui-tree-line",lineBoundary:{top:2,bottom:2}},o=["INPUT","BUTTON","UL"],r=n.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]),a=tui.util.inArray,l=tui.util.forEach,u=[],h=tui.util.defineClass({"static":{getAPIList:function(){return u.slice()}},init:function(e,t){t=tui.util.extend({},s,t),this.tree=e,this.helperElement=null,this.userSelectPropertyKey=null,this.userSelectPropertyValue=null,this.currentNodeId=null,this.hoveredElement=null,this.movingLineType=null,this.timer=null,this.rejectedTagNames=o.concat(t.rejectedTagNames),this.rejectedClassNames=[].concat(t.rejectedClassNames),this.useHelper=t.useHelper,this.helperPos=t.helperPos,this.autoOpenDelay=t.autoOpenDelay,this.isSortable=t.isSortable,this.hoverClassName=t.hoverClassName,this.lineClassName=t.lineClassName,this.lineBoundary=t.lineBoundary,this._initHelper(),this.isSortable&&this._initMovingLine(),this._attachMousedown()},destroy:function(){this._restoreTextSelection(),this._detachMousedown()},_changeHelperPosition:function(e){var t=this.helperElement.style,i=this.tree.rootElement.getBoundingClientRect();t.top=e.y-i.top+this.helperPos.y+"px",t.left=e.x-i.left+this.helperPos.x+"px",t.display=""},_initHelper:function(){var e=document.createElement("span"),t=e.style;t.position="absolute",t.display="none",this.tree.rootElement.parentNode.appendChild(e),this.helperElement=e},_initMovingLine:function(){var e=document.createElement("div"),t=e.style;t.position="absolute",t.visibility="hidden",e.className=this.lineClassName,this.tree.rootElement.parentNode.appendChild(e),this.lineElement=e},_setHelper:function(e){this.helperElement.innerHTML=e},_attachMousedown:function(){this._preventTextSelection(),this.tree.on("mousedown",this._onMousedown,this)},_detachMousedown:function(){this.tree.off(this)},_preventTextSelection:function(){var e=this.tree.rootElement.style;n.addEventListener(this.tree.rootElement,"selectstart",n.preventDefault),this.userSelectPropertyKey=r,this.userSelectPropertyValue=e[r],e[r]="none"},_restoreTextSelection:function(){n.removeEventListener(this.tree.rootElement,"selectstart",n.preventDefault),this.userSelectPropertyKey&&(this.tree.rootElement.style[this.userSelectPropertyKey]=this.userSelectPropertyValue)},_isNotDraggable:function(e){var t,i=e.tagName.toUpperCase(),s=n.getClass(e).split(/\s+/);return a(i,this.rejectedTagNames)!==-1||(l(s,function(e){return t=a(e,this.rejectedClassNames)!==-1,!t},this),t)},_onMousedown:function(e){var t=this.tree,i=n.getTarget(e);n.isRightButton(e)||this._isNotDraggable(i)||(n.preventDefault(e),this.currentNodeId=t.getNodeIdFromElement(i),this.useHelper&&this._setHelper(i.innerText||i.textContent),t.on({mousemove:this._onMousemove,mouseup:this._onMouseup},this))},_onMousemove:function(e){var t,i=n.getMousePos(e),s=n.getTarget(e);this.useHelper&&(this._changeHelperPosition(i),t=this.tree.getNodeIdFromElement(s),t&&this._applyMoveAction(t,i))},_onMouseup:function(e){var t=this.tree,i=n.getTarget(e),s=t.getNodeIdFromElement(i),o=-1;s&&this.isSortable&&this.movingLineType&&(o=this._getIndexForInserting(s),s=t.getParentId(s)),this.currentNodeId!==s&&t.move(this.currentNodeId,s,o),this._reset()},_applyMoveAction:function(e,t){var i,s=document.getElementById(e),o=s.getBoundingClientRect(),r=n.hasClass(s,this.hoverClassName),a=this._isContain(o,t);!this.hoveredElement&&a?(this.hoveredElement=s,this._hover(e)):(!r||r&&!a)&&this._unhover(),this.isSortable&&(i=this._getBoundaryType(o,t),this._drawBoundaryLine(o,i))},_hover:function(e){var t=this.tree;n.addClass(this.hoveredElement,this.hoverClassName),t.isLeaf(e)||(this.timer=setTimeout(function(){t.open(e)},this.autoOpenDelay))},_unhover:function(){clearTimeout(this.timer),n.removeClass(this.hoveredElement,this.hoverClassName),this.hoveredElement=null,this.timer=null},_isContain:function(e,t){var i=e.top,n=e.bottom;return this.isSortable&&(i+=this.lineBoundary.top,n-=this.lineBoundary.bottom),e.left<t.x&&e.right>t.x&&i<t.y&&n>t.y},_getBoundaryType:function(e,t){var i;return t.y<e.top+this.lineBoundary.top?i="top":t.y>e.bottom-this.lineBoundary.bottom&&(i="bottom"),i},_drawBoundaryLine:function(e,t){var i,s,o=this.lineElement.style;t?(s=this.tree.rootElement.parentNode.scrollTop+n.getWindowScrollTop(),i=Math.round(this.lineElement.offsetHeight/2),o.top=Math.round(e[t])-i+s+"px",o.visibility="visible",this.movingLineType=t):(o.visibility="hidden",this.movingLineType=null)},_getIndexForInserting:function(e){var t=this.tree.getNodeIndex(e);return"bottom"===this.movingLineType&&(t+=1),t},_reset:function(){this.isSortable&&(this.lineElement.style.visibility="hidden"),this.hoveredElement&&(n.removeClass(this.hoveredElement,this.hoverClassName),this.hoveredElement=null),this.helperElement.style.display="none",this.currentNodeId=null,this.movingLineType=null,this.tree.off(this,"mousemove"),this.tree.off(this,"mouseup")}});t.exports=h},{"./../util":16}],11:[function(e,t,i){"use strict";var n=e("./../util"),s=e("./../consts/ajaxCommand"),o=e("./../consts/states"),r=["createChildNode","editNode"],a={CREATE:"create",UPDATE:"update"},l=tui.util.defineClass({"static":{getAPIList:function(){return r.slice()}},init:function(e,t){t=tui.util.extend({},t),this.tree=e,this.editableClassName=t.editableClassName,this.dataKey=t.dataKey,this.defaultValue=t.defaultValue||"",this.inputElement=this._createInputElement(t.inputClassName),this.mode=null,this.boundOnKeyup=tui.util.bind(this._onKeyup,this),this.boundOnBlur=tui.util.bind(this._onBlur,this),e.on("doubleClick",this._onDoubleClick,this),n.addEventListener(this.inputElement,"keyup",this.boundOnKeyup),n.addEventListener(this.inputElement,"blur",this.boundOnBlur),this._setAPIs()},destroy:function(){var e=this.tree;this._detachInputElement(),e.off(this),tui.util.forEach(r,function(t){delete e[t]}),n.removeEventListener(this.inputElement,"keyup",this.boundOnKeyup),n.removeEventListener(this.inputElement,"blur",this.boundOnBlur)},createChildNode:function(e){var t,i=this.tree,n=i.enabledFeatures.Ajax;this.mode=a.CREATE,n&&i.on("successAjaxResponse",this._onSuccessResponse,this),i.isLeaf(e)||i.getState(e)!==o.node.CLOSED?(t=i._add({},e)[0],this._attachInputElement(t)):i.open(e)},editNode:function(e){this.mode=a.UPDATE,this._attachInputElement(e)},_onSuccessResponse:function(e,t){var i,n,o=this.tree;e===s.READ&&t&&(i=o.getParentId(t[0]),n=o._add({},i)[0],this._attachInputElement(n))},_onDoubleClick:function(e){var t,i=n.getTarget(e);n.hasClass(i,this.editableClassName)&&(t=this.tree.getNodeIdFromElement(i),this.editNode(t))},_onKeyup:function(e){n.removeEventListener(this.inputElement,"blur",this.boundOnBlur),13===e.keyCode&&(this.mode===a.CREATE?this._addData():this._setData())},_onBlur:function(){this.mode===a.CREATE?this._addData():this._setData()},_createInputElement:function(e){var t=document.createElement("INPUT");return e&&(t.className=e),t.setAttribute("type","text"),t},_attachInputElement:function(e){var t,i=this.tree,s=document.getElementById(e),o=n.getElementsByClassName(s,i.classNames.textClass)[0];t=this.inputElement,t.value=i.getNodeData(e)[this.dataKey]||"",o.parentNode.insertBefore(t,o),o.style.display="none",this.inputElement=s.getElementsByTagName("input")[0],this.inputElement.focus(),n.addEventListener(this.inputElement,"keyup",this.boundOnKeyup),n.addEventListener(this.inputElement,"blur",this.boundOnBlur)},_detachInputElement:function(){var e=this.tree,t=this.inputElement,i=t.parentNode;i&&i.removeChild(t),e.enabledFeatures.Ajax&&e.off(this,"successAjaxResponse"),n.removeEventListener(this.inputElement,"keyup",this.boundOnKeyup),n.removeEventListener(this.inputElement,"blur",this.boundOnBlur)},_addData:function(){var e=this.tree,t=e.getNodeIdFromElement(this.inputElement),i=e.getParentId(t),n={};this.tree.invoke("beforeCreateChildNode")&&(t&&(n[this.dataKey]=this.inputElement.value||this.defaultValue,e._remove(t),e.add(n,i)),this._detachInputElement())},_setData:function(){var e=this.tree,t=e.getNodeIdFromElement(this.inputElement),i={};this.tree.invoke("beforeEditNode")&&(t&&(i[this.dataKey]=this.inputElement.value,e.setNodeData(t,i)),this._detachInputElement())},_setAPIs:function(){var e=this.tree,t=tui.util.bind;tui.util.forEach(r,function(i){e[i]=t(this[i],this)},this)}});t.exports=l},{"./../consts/ajaxCommand":2,"./../consts/states":6,"./../util":16}],12:[function(e,t,i){"use strict";var n=e("./../util"),s=["select","getSelectedNodeId"],o={selectedClassName:"tui-tree-selected"},r=tui.util.defineClass({"static":{getAPIList:function(){return s.slice()}},init:function(e,t){t=tui.util.extend({},o,t),this.tree=e,this.selectedClassName=t.selectedClassName,this.selectedNodeId=null,e.on({singleClick:this.onSingleClick,afterDraw:this.onAfterDraw},this),this._setAPIs()},_setAPIs:function(){var e=this.tree,t=tui.util.bind;tui.util.forEach(s,function(i){e[i]=t(this[i],this)},this)},destroy:function(){var e=this.tree,t=this.getPrevElement();n.removeClass(t,this.selectedClassName),e.off(this),tui.util.forEach(s,function(t){delete e[t]})},onSingleClick:function(e){var t=n.getTarget(e),i=this.tree.getNodeIdFromElement(t);this.select(i,t)},select:function(e,t){var i,s,o,r,a;e&&(i=this.tree,s=this.getPrevElement(),o=document.getElementById(e),r=this.selectedClassName,a=this.selectedNodeId,i.invoke("beforeSelect",e,a,t)&&(n.removeClass(s,r),n.addClass(o,r),i.fire("select",e,a,t),this.selectedNodeId=e))},getPrevElement:function(){return document.getElementById(this.selectedNodeId)},getSelectedNodeId:function(){return this.selectedNodeId},onAfterDraw:function(){var e=this.getPrevElement();e&&n.addClass(e,this.selectedClassName)}});t.exports=r},{"./../util":16}],13:[function(e,t,i){"use strict";function n(e,t){var i="INVALID_API_"+e.toUpperCase(),n=t.getAPIList?t.getAPIList():[];E.forEach(n,function(e){y.prototype[e]=function(){throw new Error(a[i]||a.INVALID_API)}})}var s=e("./util"),o=e("./consts/defaultOption"),r=e("./consts/states"),a=e("./consts/messages"),l=e("./consts/outerTemplate"),u=e("./consts/ajaxCommand"),h=e("./treeModel"),d=e("./features/selectable"),c=e("./features/draggable"),m=e("./features/editable"),f=e("./features/checkbox"),g=e("./features/contextMenu"),p=e("./features/ajax"),v=r.node,_={Selectable:d,Draggable:c,Editable:m,Checkbox:f,ContextMenu:g,Ajax:p},E=tui.util,C=E.extend,I=200,N=5,y=E.defineClass({init:function(e,t){t=C({},o,t),this.classNames=C({},o.classNames,t.classNames),this.template=C({},o.template,t.template),this.rootElement=t.rootElement,this.stateLabels=t.stateLabels,this.model=new h(e,t),this.enabledFeatures={},this.clickTimer=null,this._mouseMovingFlag=!1,this._renderTemplate=t.renderTemplate||s.renderTemplate,this.isMovingNode=!1,this._setRoot(),this._draw(this.getRootNodeId()),this._setEvents()},_setRoot:function(){var e=this.rootElement;if(E.isString(e)&&(e=this.rootElement=document.getElementById(e)),!E.isHTMLNode(e))throw new Error(a.INVALID_ROOT_ELEMENT)},_onMove:function(e,t,i,n){this._draw(t),this._draw(i),this.fire("move",{nodeId:e,originalParentId:t,newParentId:i,index:n})},_setEvents:function(){this.model.on({update:this._draw,move:this._onMove},this),s.addEventListener(this.rootElement,"click",E.bind(this._onClick,this)),s.addEventListener(this.rootElement,"mousedown",E.bind(this._onMousedown,this)),s.addEventListener(this.rootElement,"dblclick",E.bind(this._onDoubleClick,this)),s.addEventListener(this.rootElement,"contextmenu",E.bind(this._onContextMenu,this))},_onContextMenu:function(e){this.fire("contextmenu",e)},_onMousedown:function(e){function t(e){var t=e.clientX,i=e.clientY;l(t-r)+l(i-a)>N&&(o.fire("mousemove",e),o._mouseMovingFlag=!0)}function i(e){o.fire("mouseup",e),s.removeEventListener(document,"mousemove",t),s.removeEventListener(document,"mouseup",i),s.removeEventListener(document,"mouseout",n)}function n(e){null===e.toElement&&o.fire("mouseup",e)}var o=this,r=e.clientX,a=e.clientY,l=Math.abs;this._mouseMovingFlag=!1,this.fire("mousedown",e),s.addEventListener(document,"mousemove",t),s.addEventListener(document,"mouseup",i),s.addEventListener(document,"mouseout",n)},_onClick:function(e){var t=s.getTarget(e),i=this;return s.isRightButton(e)?void(this.clickTimer=null):s.hasClass(t,this.classNames.toggleBtnClass)?void this.toggle(this.getNodeIdFromElement(t)):void(this.clickTimer||this._mouseMovingFlag||(this.fire("singleClick",e),this.clickTimer=setTimeout(function(){i.resetClickTimer()},I)))},_onDoubleClick:function(e){this.fire("doubleClick",e),this.resetClickTimer()},_setDisplayFromNodeState:function(e,t){var i,n,o,r=this._getSubtreeElement(e);r&&r!==this.rootElement&&(i=this.stateLabels[t],o=document.getElementById(e),n=s.getElementsByClassName(o,this.classNames.toggleBtnClass)[0],t===v.OPENED?r.style.display="":r.style.display="none",this._setNodeClassNameFromState(o,t),n&&(n.innerHTML=i))},_setNodeClassNameFromState:function(e,t){var i=this.classNames,n=i[v.OPENED+"Class"],o=i[v.CLOSED+"Class"];s.removeClass(e,n),s.removeClass(e,o),s.addClass(e,i[t+"Class"])},_makeHtml:function(e){var t=this.model,i="";return E.forEach(e,function(e){var n,o,r=t.getNode(e);r&&(n=this._getTemplate(r),o=this._makeTemplateProps(r),o.innerTemplate=this._makeInnerHTML(r,{source:n.inner,props:o}),i+=s.renderTemplate(n.outer,o))},this),i},_makeInnerHTML:function(e,t){var i,n;return t=t||{},i=t.source||this._getTemplate(e).inner,n=t.props||this._makeTemplateProps(e),this._renderTemplate(i,n)},_getTemplate:function(e){var t;return t=e.isLeaf()?{inner:this.template.leafNode,outer:l.LEAF_NODE}:{inner:this.template.internalNode,outer:l.INTERNAL_NODE}},_makeTemplateProps:function(e){var t,i,n=this.classNames;return e.isLeaf()?t={id:e.getId(),isLeaf:!0}:(i=e.getState(),t={id:e.getId(),stateClass:n[i+"Class"],stateLabel:this.stateLabels[i],children:this._makeHtml(e.getChildIds())}),C(t,n,e.getAllData())},_draw:function(e){var t,i,n=this.model.getNode(e);n&&(this.fire("beforeDraw",e),n.isRoot()?(i=this._makeHtml(n.getChildIds()),t=this.rootElement):(i=this._makeInnerHTML(n),t=document.getElementById(e)),t.innerHTML=i,this._setClassWithDisplay(n),this.fire("afterDraw",e))},_setClassWithDisplay:function(e){var t=e.getId(),i=document.getElementById(t),n=this.classNames;s.removeClass(i,n.leafClass),e.isLeaf()?(s.removeClass(i,n.openedClass),s.removeClass(i,n.closedClass),s.addClass(i,n.leafClass)):(this._setDisplayFromNodeState(t,e.getState()),this.each(function(e){this._setClassWithDisplay(e)},t,this))},_getSubtreeElement:function(e){var t,i=this.model.getNode(e);return t=!i||i.isLeaf()?null:i.isRoot()?this.rootElement:s.getElementsByClassName(document.getElementById(e),this.classNames.subtreeClass)[0]},getDepth:function(e){return this.model.getDepth(e)},getLastDepth:function(){return this.model.getLastDepth()},getRootNodeId:function(){return this.model.rootNode.getId()},getChildIds:function(e){return this.model.getChildIds(e)},getParentId:function(e){return this.model.getParentId(e)},resetClickTimer:function(){window.clearTimeout(this.clickTimer),this.clickTimer=null},getNodeIdFromElement:function(e){for(var t=this.getNodeIdPrefix();e&&e.id.indexOf(t)===-1;)e=e.parentElement;return e?e.id:""},getNodeIdPrefix:function(){return this.model.getNodeIdPrefix()},getNodeData:function(e){return this.model.getNodeData(e)},setNodeData:function(e,t,i){var n=this,s=this.enabledFeatures.Ajax,o=i?i.useAjax:!!s,r=!!i&&i.isSilent;o?s.loadData(u.UPDATE,function(){n._setNodeData(e,t)},{nodeId:e,data:t,type:"set"}):this._setNodeData(e,t,r)},_setNodeData:function(e,t,i){this.model.setNodeData(e,t,i)},removeNodeData:function(e,t,i){var n=this,s=this.enabledFeatures.Ajax,o=i?i.useAjax:!!s,r=!!i&&i.isSilent;o?s.loadData(u.UPDATE,function(){n._removeNodeData(e,t)},{nodeId:e,names:t,type:"remove"}):this._removeNodeData(e,t,r)},_removeNodeData:function(e,t,i){this.model.removeNodeData(e,t,i)},getState:function(e){var t=this.model.getNode(e);return t?t.getState():null},open:function(e){var t=this.model.getNode(e),i=v.OPENED;t&&!t.isRoot()&&(t.setState(i),this._setDisplayFromNodeState(e,i)),this.enabledFeatures.Ajax&&this._reload(e)},close:function(e){var t=this.model.getNode(e),i=v.CLOSED;t&&!t.isRoot()&&(t.setState(i),this._setDisplayFromNodeState(e,i))},toggle:function(e){var t,i=this.model.getNode(e);i&&!i.isRoot()&&(i.toggleState(),t=i.getState(),this._setDisplayFromNodeState(e,t),this.enabledFeatures.Ajax&&this._reload(e))},_reload:function(e){var t=this.model.getNode(e),i=t.getState(),n=E.isUndefined(t.getData("reload"))||t.getData("reload");i===v.CLOSED&&this._setNodeData(e,{reload:!1},!0),i===v.OPENED&&n&&this.resetAllData(null,{nodeId:e,useAjax:!0})},sort:function(e,t){this.model.sort(e),t||this.refresh()},refresh:function(e){e=e||this.getRootNodeId(),this._draw(e)},eachAll:function(e,t){this.model.eachAll(e,t)},each:function(e,t,i){this.model.each(e,t,i)},add:function(e,t,i){var n,s=this,o=this.enabledFeatures.Ajax,r=i?i.useAjax:!!o,a=!!i&&i.isSilent;return r?o.loadData(u.CREATE,function(){return s._add(e,t)},{parentId:t,data:e}):n=this._add(e,t,a),n},_add:function(e,t,i){return this.model.add(e,t,i)},resetAllData:function(e,t){var i,n=this,s=this.enabledFeatures.Ajax,o=t?t.nodeId:this.getRootNodeId(),r=t?t.useAjax:!!s;return r?s.loadData(u.READ,function(e){return n._resetAllData(e,o)},{nodeId:o}):i=this._resetAllData(e,o),i},_resetAllData:function(e,t){return this._removeAllChildren(t,{isSilent:!0}),this._add(e,t)},removeAllChildren:function(e,t){var i=this,n=this.enabledFeatures.Ajax,s=t?t.useAjax:!!n,o=!!t&&t.isSilent;s?n.loadData(u.DELETE_ALL_CHILDREN,function(){i._removeAllChildren(e)},{nodeId:e}):this._removeAllChildren(e,o)},_removeAllChildren:function(e,t){var i=this.getChildIds(e);E.forEach(i,function(e){this._remove(e,!0)},this),t||this._draw(e)},remove:function(e,t){var i=this,n=this.enabledFeatures.Ajax,s=t?t.useAjax:!!n,o=!!t&&t.isSilent;s?n.loadData(u.DELETE,function(){i._remove(e)},{nodeId:e}):this._remove(e,o)},_remove:function(e,t){this.model.remove(e,t)},move:function(e,t,i,n){var s=this,o=this.enabledFeatures.Ajax,r=n?n.useAjax:!!o,a=!!n&&n.isSilent;r?o.loadData(u.MOVE,function(){s.getParentId(e)!==t&&s.setNodeData(t,{reload:!0},!0),s._move(e,t,i)},{nodeId:e,newParentId:t,index:i}):this._move(e,t,i,a)},_move:function(e,t,i,n){this.invoke("beforeMove",e,t)&&(this.isMovingNode=!0,this.model.move(e,t,i,n),this.isMovingNode=!1)},search:function(e,t){return E.isObject(e)?E.isFunction(e)?this._filter(e,t):this._where(e):[]},_where:function(e){return this._filter(function(t){var i=!0,n=t.getAllData();return E.forEach(e,function(e,t){return i=t in n&&n[t]===e}),i})},_filter:function(e,t){var i=[];return this.eachAll(function(t,n){e(t,n)&&i.push(n)},t),i},isLeaf:function(e){var t=this.model.getNode(e);return t&&t.isLeaf()},contains:function(e,t){return this.model.contains(t,t)},enableFeature:function(e,t){var i=_[e];return this.disableFeature(e),i&&(this.enabledFeatures[e]=new i(this,t),this.fire("initFeature")),this},disableFeature:function(e){var t=this.enabledFeatures[e];return t&&(t.destroy(),delete this.enabledFeatures[e]),this},getNodeIndex:function(e){var t=this.model.getParentId(e);return this.model.getNode(t).getChildIndex(e)}});E.forEach(_,function(e,t){n(t,e)}),E.CustomEvents.mixin(y),t.exports=y},{"./consts/ajaxCommand":2,"./consts/defaultOption":3,"./consts/messages":4,"./consts/outerTemplate":5,"./consts/states":6,"./features/ajax":7,"./features/checkbox":8,"./features/contextMenu":9,"./features/draggable":10,"./features/editable":11,"./features/selectable":12,"./treeModel":14,"./util":16}],14:[function(e,t,i){"use strict";var n=e("./treeNode"),s=tui.util.extend,o=tui.util.keys,r=tui.util.forEach,a=tui.util.map,l=tui.util.defineClass({init:function(e,t){n.setIdPrefix(t.nodeIdPrefix),this.nodeDefaultState=t.nodeDefaultState,this.rootNode=new n({state:"opened"},null),this.treeHash={},this._setData(e)},getNodeIdPrefix:function(){return n.idPrefix},_setData:function(e){var t=this.rootNode,i=t.getId();this.treeHash[i]=t,this._makeTreeHash(e,t)},_makeTreeHash:function(e,t){var i=t.getId(),n=[];return r(e,function(e){var s=e.children,o=this._createNode(e,i),r=o.getId();n.push(r),this.treeHash[r]=o,t.addChildId(r),this._makeTreeHash(s,o)},this),n},_createNode:function(e,t){return e=s({state:this.nodeDefaultState},e),new n(e,t)},getChildren:function(e){var t=this.getChildIds(e);return t?a(t,function(e){return this.getNode(e)},this):null},getChildIds:function(e){var t=this.getNode(e);return t?t.getChildIds():null},getCount:function(){return o(this.treeHash).length},getLastDepth:function(){var e=a(this.treeHash,function(e){return this.getDepth(e.getId())},this);return Math.max.apply(null,e)},getNode:function(e){return this.treeHash[e]},getDepth:function(e){var t,i=this.getNode(e),n=0;if(!i)return null;for(t=this.getNode(i.getParentId());t;)n+=1,t=this.getNode(t.getParentId());return n},getParentId:function(e){var t=this.getNode(e);return t?t.getParentId():null},remove:function(e,t){var i,n=this.getNode(e);n&&(i=this.getNode(n.getParentId()),r(n.getChildIds(),function(e){this.remove(e,!0)},this),i.removeChildId(e),delete this.treeHash[e],t||this.fire("update",i.getId()))},add:function(e,t,i){var n,s=this.getNode(t)||this.rootNode;return e=[].concat(e),n=this._makeTreeHash(e,s),i||this.fire("update",s.getId()),n},setNodeData:function(e,t,i){var n=this.getNode(e);n&&t&&(n.setData(t),i||this.fire("update",e))},removeNodeData:function(e,t,i){var n=this.getNode(e);n&&t&&(tui.util.isArray(t)?n.removeData.apply(n,t):n.removeData(t),i||this.fire("update",e))},move:function(e,t,i,n){var s,o,r,a=this.getNode(e);a&&(r=this.getNode(t)||this.rootNode,t=r.getId(),o=a.getParentId(),s=this.getNode(o),i=tui.util.isUndefined(i)?-1:i,e===t||this.contains(e,t)||(i!==-1?t===o?r.moveChildId(e,i):(r.insertChildId(e,i),s.removeChildId(e)):(r.addChildId(e),s.removeChildId(e)),a.setParentId(t),n||this.fire("move",e,o,t,i)))},contains:function(e,t){for(var i=this.getParentId(t),n=!1;!n&&i;)n=e===i,i=this.getParentId(i);return n},sort:function(e){this.eachAll(function(t,i){var n,s=this.getChildren(i);s.length>1&&(s.sort(e),
n=a(s,function(e){return e.getId()}),t.replaceChildIds(n))})},getNodeData:function(e){var t=this.getNode(e);return t?t.getAllData():null},eachAll:function(e,t){t=t||this,r(this.treeHash,function(){e.apply(t,arguments)})},each:function(e,t,i){var n,s,o;if(o=this.getNode(t))for(n=o.getChildIds(),i=i||this;n.length;)s=n.pop(),o=this.getNode(s),e.call(i,o,s),n=n.concat(o.getChildIds())}});tui.util.CustomEvents.mixin(l),t.exports=l},{"./treeNode":15}],15:[function(e,t,i){"use strict";var n=e("./consts/states").node,s=e("./util"),o=0,r=function(){var e=o;return o+=1,e},a={id:"",state:"setState",children:""},l=tui.util.inArray,u=tui.util.defineClass({"static":{setIdPrefix:function(e){this.idPrefix=e||this.idPrefix},idPrefix:""},init:function(e,t){this._id=this.constructor.idPrefix+r(),this._parentId=t,this._childIds=[],this._data={},this._state=n.CLOSED,this.setData(e)},_setReservedProperties:function(e){return tui.util.forEachOwnProperties(a,function(t,i){var n=e[i];n&&t&&this[t](n),delete e[i]},this),e},toggleState:function(){this._state===n.CLOSED?this._state=n.OPENED:this._state=n.CLOSED},setState:function(e){e=String(e),this._state=n[e.toUpperCase()]||this._state},getState:function(){return this._state},getId:function(){return this._id},getParentId:function(){return this._parentId},setParentId:function(e){this._parentId=e},replaceChildIds:function(e){this._childIds=e},getChildIds:function(){return this._childIds.slice()},addChildId:function(e){var t=this._childIds;tui.util.inArray(t,e)===-1&&t.push(e)},removeChildId:function(e){s.removeItemFromArray(e,this._childIds)},getData:function(e){return this._data[e]},getAllData:function(){return tui.util.extend({},this._data)},setData:function(e){e=this._setReservedProperties(e),tui.util.extend(this._data,e)},removeData:function(){tui.util.forEachArray(arguments,function(e){delete this._data[e]},this)},hasChild:function(e){return l(e,this._childIds)!==-1},isLeaf:function(){return!this._childIds.length&&!this.getData("hasChild")},isRoot:function(){return tui.util.isFalsy(this._parentId)},getChildIndex:function(e){return l(e,this._childIds)},insertChildId:function(e,t){var i=this._childIds;l(e,i)===-1&&i.splice(t,0,e)},moveChildId:function(e,t){var i=this._childIds,n=this.getChildIndex(e);l(e,i)!==-1&&(n<t&&(t-=1),i.splice(t,0,i.splice(n,1)[0]))}});t.exports=u},{"./consts/states":6,"./util":16}],16:[function(e,t,i){"use strict";var n=tui.util.isUndefined,s=tui.util.pick,o=/\{\{(.+?)}}/gi,r=/^\w+(?:\.\w+)*$/,a=function(e){return r.test(e)},l=tui.util.isArraySafe,u="undefined"!=typeof window.pageXOffset,h="CSS1Compat"===document.compatMode,d={removeItemFromArray:function(e,t){for(var i=t.length-1;i>-1;)e===t[i]&&t.splice(i,1),i-=1},addClass:function(e,t){e&&(""===e.className?e.className=t:d.hasClass(e,t)||(e.className+=" "+t))},removeClass:function(e,t){var i,n,s=d.getClass(e);s&&(i=s.split(" "),n=tui.util.inArray(t,i),n!==-1&&(i.splice(n,1),e.className=i.join(" ")))},addEventListener:function(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent("on"+t,i)},removeEventListener:function(e,t,i){e.removeEventListener?e.removeEventListener(t,i,!1):e.detachEvent("on"+t,i)},getTarget:function(e){var t;return e=e||window.event,t=e.target||e.srcElement},getClass:function(e){return e&&e.getAttribute&&(e.getAttribute("class")||e.getAttribute("className")||"")},hasClass:function(e,t){var i=d.getClass(e);return i.indexOf(t)>-1},getElementsByClassName:function(e,t){var i,n;return e.querySelectorAll?n=e.querySelectorAll("."+t):(i=tui.util.toArray(e.getElementsByTagName("*")),n=tui.util.filter(i,function(e){var i=e.className||"";return i.indexOf(t)!==-1})),n},isRightButton:function(e){return 2===d._getButton(e)},testProp:function(e){var t=document.documentElement.style,i=!1;return tui.util.forEach(e,function(e){if(e in t)return i=e,!1}),i},preventDefault:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},renderTemplate:function(e,t){function i(e){return s.apply(null,[t].concat(e))}return e.replace(o,function(e,t){var s;return a(t)&&(s=i(t.split("."))),l(s)?s=s.join(" "):n(s)&&(s=""),s})},_getButton:function(e){var t,i="0,1,3,5,7",n="2,6",s="4";return document.implementation.hasFeature("MouseEvents","2.0")?e.button:(t=String(e.button),i.indexOf(t)>-1?0:n.indexOf(t)>-1?2:s.indexOf(t)>-1?1:null)},getMousePos:function(e){return{x:e.clientX,y:e.clientY}},getWindowScrollTop:function(){var e;return e=u?window.pageYOffset:h?document.documentElement.scrollTop:document.body.scrollTop}};t.exports=d},{}]},{},[1]);